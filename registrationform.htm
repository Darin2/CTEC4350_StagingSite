
<!DOCTYPE HTML>
<html>
 <head>
  <title> CTEC 4350: Exercises: Form Tips</title>
  <style>
	form div {margin: 10px; font-family: arial, sans-serif; vertical-align: text-top; clear: left; margin: 20px 5px;}

	form div label:first-of-type {display: inline-block; width: 250px; text-align: right; padding: 0px 5px; }

	.tips {border: 10px solid #ddd; border-radius: 0 30px 30px 30px; padding: 30px; background-color: #ccffff; display: none; position: absolute;}

	#termsAndConditions {
		display: none;
	}

	.errMsg {display: block; background-color: white; color: #ff6600; font-size: 0.8em; padding: 2px; width: 500px; position: relative; left: 250px;}
  </style>
  <script>
	function init(){
		document.getElementById('userName').addEventListener('focus', showTips, false);
		document.getElementById('userName').addEventListener('blur', showTips, false);

		document.getElementById('password').addEventListener('focus', showTips, false);
		document.getElementById('password').addEventListener('blur', showTips, false);

		document.getElementById('registrationForm').addEventListener('submit', process, false);
	}

	function showTips(evt){

		// get the id for the tip span; note the keyword "this" refers to the object on which the event occured -- the form input element that's on focus.
		var tipId = this.id+"Tips";

		// set the tip object
		var tip = document.getElementById(tipId);

		// place the tip based on corresponding form input's (vertical) position
		var y = this.offsetTop;
		var x = this.offsetWidth + this.offsetLeft+ 50;
		tip.style.top = y+"px";
		tip.style.left = x+"px";


		// get the event object
		evt = (evt) ? evt:((window.event) ? event : null);

		// decide the value for the dispaly property of the tip and the background color of the form input based on the type of the event
		if (evt.type == "focus")
		{
			var displayValue = "block";
			var bgColor = "#ccffff";
		} else {
			var displayValue = "none";
			var bgColor = "white";
		}

		tip.style.display = displayValue;
		this.style.backgroundColor = bgColor;
	}

	function addErrorMessage(fieldId, msg){
		//console.log(msg);

		// highlight the lable
		document.getElementById(fieldId+"Label").style.color = "red";

		// check if an error message span is available
		if (document.getElementById(fieldId + "ErrMsg"))
		{
			// an error message span is already available, use it
			document.getElementById(fieldId + "ErrMsg").innerHTML = msg;
			document.getElementById(fieldId + "ErrMsg").style.display = "block";
		} else {

			// otherwise, create the error message span
			var messageSpan = document.createElement("span");
			messageSpan.className = "errMsg"; // set the CSS class to use
			messageSpan.id = fieldId + "ErrMsg"; // set the id
			messageSpan.innerHTML = msg;

			var inputLabel = document.getElementById(fieldId+'Label');
			inputLabel.parentNode.appendChild(messageSpan);

		}

	}

	function removeErrorMessage (fieldId){
		if (document.getElementById(fieldId + "ErrMsg"))
		{
			document.getElementById(fieldId+"Label").style.color = "black";
			document.getElementById(fieldId + "ErrMsg").style.display = "none";
		}

	}

	function process(evt){

		// data validation
		var err = 0;

		// get user input
		var userName = document.getElementById('userName').value;

		var userNamePattern = /^[A-Z 0-9 \.\-']{6,20}$/i;

		if (userNamePattern.test(userName)) {
			removeErrorMessage('userName');
		} else {
			addErrorMessage('userName', 'The user name should be 6-20 characters usng only letter, numbers, dots, and/or dashes.');
			err ++;
		}

		// password






		// action
		var message = "";
		if (err == 0) // data are all valid
		{
		// frequency
		var deliveryFreq = "";
			var radioArr = document.getElementsByName('delivery');
			for (i=0; i<radioArr.length;i++ )
			{
				if (radioArr[i].checked)
				{
					deliveryFreq = radioArr[i].value;
					break;
				}
			}


			var newsletterList = []; // an empty array ready to store newsletter picks
			var checkboxArr = document.getElementsByName('newsletters');
			// loop through all checkboxes
			for (i=0;i<checkboxArr.length ;i++ )
			{
				// for each checkbox, see if it is checked
				if (checkboxArr[i].checked)
				{
					// add ('push') the value of this checked checkbox into the newsletterList array
					newsletterList.push(checkboxArr[i].value);
				}
			}


			message = "You have submitted the following information. Thank you for your subscription.<br><ul> ";
			message += "<li>User name: " + document.getElementById('userName').value + "<br/>";
			message += "<li>Delivery frequency: " + deliveryFreq + "<br/>";
			message += "<li>Newsletters: " + newsletterList;
			message += "</ul>";


		} else {
			message = "There are errors.";
		}

		document.getElementById('response').innerHTML = message;

		// disable submit button


		// prevent form submission
		if (evt.preventDefault)
		{
			evt.preventDefault();
		} else {
			evt.returnValue = false;
		}

	}

	window.addEventListener('load', init, false);
  </script>
 </head>

 <body>

  <h1>Registration Form</h1>

  <form id="registrationForm" action="" method="post">

	<div>
		<label for="userName" id="userNameLabel">User Name: </label>
		<input type="text" size="25" id="userName">
	</div>
	<span class="tips" id="userNameTips">Your user name should contain 6-20 characters usng only letter, numbers, dots, and/or dashes.</span>

	<div>
		<label for="password" id="passwordLabel">Password: </label>
		<input type="password" size="25" id="password">
	</div>
	<span class="tips" id="passwordTips">Your password should contain 6-20 characters.</span>

	<div>
		<label id="deliveryLabel">Delivery Frequency: </label>
		<input type="radio" name="delivery" value="daily" id="frequncy_daily"> <label for="frequncy_daily">Daily</label>
		<input type="radio" name="delivery" value="weekly" id="frequncy_weekly"> <label for="frequncy_weekly">Weekly</label>
		<input type="radio" name="delivery" value="monthly" id="frequncy_monthly"> <label for="frequncy_monthly">Monthly</label>
	</div>
	<span class="tips" id="deliveryTips">Please pick a delivery frequency.</span>

	<div>
		<label id="newslettersLabel">Newsletter Choices: </label>
		<input type="checkbox" name="newsletters" value="CSS3" id="newsletters_css3"> <label for="newsletters_css3">CSS3</label>
		<input type="checkbox" name="newsletters" value="HTML5" id="newsletters_html5"> <label for="newsletters_html5">HTML5</label>
		<input type="checkbox" name="newsletters" value="JavaScript" id="newsletters_javascript"> <label for="newsletters_javascript">JavaScript</label>
	</div>

	<div>
		<label id="termsLabel">Terms and Conditions</label>
		<p id="termsAndConditions">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam tincidunt, purus in elementum facilisis, augue mi bibendum urna, et hendrerit augue quam vel massa. Proin vel ultricies libero, vitae suscipit orci. Pellentesque scelerisque velit tellus, non placerat lectus ultricies vel. Curabitur elementum lobortis ligula et bibendum. Vivamus sit amet risus ut purus tristique euismod sed et lacus. Vestibulum ac porttitor felis. Aenean egestas leo quis dignissim tincidunt. Integer id velit nec dui tristique accumsan id et quam. </p>
		<input type="checkbox" value="agree" name="terms" id="terms"> <label for='terms' id="forTerms">By checking this box, I certify that I have read and agreed with the terms and conditions.</label>
	</div>

	<div>
		<label></label>
		<input type="submit" value="Submit" name="submit" id="submit">
	</div>
  </form>

  <div id="response">

  </div>
 </body>
</html>
